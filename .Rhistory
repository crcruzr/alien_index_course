for(j in 1:length(yr)) {
setTxtProgressBar(pb, i)
i.t.y <- i.t[i.t$year %in% yr[j],]
# species with more of 3 records
if (nrow(i.t.y) > 2) {
i.t.y.p <- vect(i.t.y, geom =c('x', 'y'))
i.t.y.ch<- convHull(i.t.y.ch)
spp_area[i,j] <-expanse(i.t.y.ch)
# species with 1 or 2 records
} else if (nrow(i.t.y) == 2 | nrow(i.t.y) == 1) {
spp_area[i,j] <- nrow(i.t.y)
# species without records
} else if (nrow(i.t.y) == 0) {
spp_area[i,j] <- 0
}
setTxtProgressBar(pb, i)
}
close(pb)
}
spp_area <- as.data.frame(matrix(nrow = length(sppq), ncol =  1+length(yr)))
names(spp_area) <- c( yr, 'species')
spp_area$species <- sppq
for(i in 1:length(sppq)) {
pb <- txtProgressBar(min = 0, max = 100, style = 3)
i.t <- mapp_qc_t[mapp_qc_t$species %in% sppq[i],]
for(j in 1:length(yr)) {
setTxtProgressBar(pb, i)
i.t.y <- i.t[i.t$year %in% yr[j],]
# species with more of 3 records
if (nrow(i.t.y) > 2) {
i.t.y.p <- vect(i.t.y, geom =c('x', 'y'))
i.t.y.ch<- convHull(i.t.y.ch)
spp_area[i,j] <-expanse(i.t.y.ch)
# species with 1 or 2 records
} else if (nrow(i.t.y) == 2 | nrow(i.t.y) == 1) {
spp_area[i,j] <- nrow(i.t.y)
# species without records
} else if (nrow(i.t.y) == 0) {
spp_area[i,j] <- 0
}
setTxtProgressBar(pb, i)
}
}
View(spp_area)
spp_area <- as.data.frame(matrix(nrow = length(sppq), ncol =  1+length(yr)))
names(spp_area) <- c( yr, 'species')
spp_area$species <- sppq
spp_records <- spp_area
for(i in 1:length(sppq)) {
i.t <- mapp_qc_t[mapp_qc_t$species %in% sppq[i],]
for(j in 1:length(yr)) {
i.t.y <- i.t[i.t$year %in% yr[j],]
if (nrow(i.t.y) > 2) {
spp_records[i,j] <- nrow(i.t.y)
} else if (nrow(i.t.y) == 2 | nrow(i.t.y) == 1) {
spp_records[i,j] <- nrow(i.t.y)
} else if (nrow(i.t.y) == 0) {
spp_records[i,j] <- 0
}
}
}
for(i in 1:length(sppq)) {
pb <- txtProgressBar(min = 0, max = 100, style = 3)
i.t <- mapp_qc_t[mapp_qc_t$species %in% sppq[i],]
for(j in 1:length(yr)) {
setTxtProgressBar(pb, i)
i.t.y <- i.t[i.t$year %in% yr[j],]
# species with more of 3 records
if (nrow(i.t.y) > 2) {
i.t.y.p <- vect(i.t.y, geom =c('x', 'y'))
i.t.y.ch<- convHull(i.t.y.p)
spp_area[i,j] <-expanse(i.t.y.ch)
# species with 1 or 2 records
} else if (nrow(i.t.y) == 2 | nrow(i.t.y) == 1) {
spp_area[i,j] <- nrow(i.t.y)
# species without records
} else if (nrow(i.t.y) == 0) {
spp_area[i,j] <- 0
}
setTxtProgressBar(pb, i)
}
}
m2_to_ha <- function(area_m2) {
area_ha <- area_m2 / 10000
return(area_ha)
}
spp_area <- as.data.frame(matrix(nrow = length(sppq), ncol =  1+length(yr)))
names(spp_area) <- c( yr, 'species')
spp_area$species <- sppq
for(i in 1:length(sppq)) {
pb <- txtProgressBar(min = 0, max = 100, style = 3)
i.t <- mapp_qc_t[mapp_qc_t$species %in% sppq[i],]
for(j in 1:length(yr)) {
setTxtProgressBar(pb, i)
i.t.y <- i.t[i.t$year %in% yr[j],]
# species with more of 3 records
if (nrow(i.t.y) > 2) {
i.t.y.p <- vect(i.t.y, geom =c('x', 'y'))
i.t.y.ch<- convHull(i.t.y.p)
spp_area[i,j] <-m2_to_ha(expanse(i.t.y.ch))
# species with 1 or 2 records
} else if (nrow(i.t.y) == 2 | nrow(i.t.y) == 1) {
spp_area[i,j] <- nrow(i.t.y)
# species without records
} else if (nrow(i.t.y) == 0) {
spp_area[i,j] <- 0
}
setTxtProgressBar(pb, i)
}
}
write.csv(spp_area, '02ProcessedData/area_invasive_spp.csv', row.names = F)
View(spp_records)
for(i in 1:length(sppq)) {
pb <- txtProgressBar(min = 0, max = 100, style = 3)
i.t <- mapp_qc_t[mapp_qc_t$species %in% sppq[i],]
for(j in 1:length(yr)) {
setTxtProgressBar(pb, i)
i.t.y <- i.t[i.t$year %in% yr[j],]
# species with more of 3 records
if (nrow(i.t.y) > 2) {
i.t.y.p <- vect(i.t.y, geom =c('x', 'y'))
i.t.y.ch<- convHull(i.t.y.p)
ç[i,j] <-m2_to_ha(expanse(i.t.y.ch))
# species with 1 or 2 records
} else if (nrow(i.t.y) == 2 | nrow(i.t.y) == 1) {
spp_area[i,j] <- 1
# species without records
} else if (nrow(i.t.y) == 0) {
spp_area[i,j] <- 0
}
setTxtProgressBar(pb, i)
}
}
for(i in 1:length(sppq)) {
pb <- txtProgressBar(min = 0, max = 100, style = 3)
i.t <- mapp_qc_t[mapp_qc_t$species %in% sppq[i],]
for(j in 1:length(yr)) {
setTxtProgressBar(pb, i)
i.t.y <- i.t[i.t$year %in% yr[j],]
# species with more of 3 records
if (nrow(i.t.y) > 2) {
i.t.y.p <- vect(i.t.y, geom =c('x', 'y'))
i.t.y.ch<- convHull(i.t.y.p)
ç[i,j] <-m2_to_ha(expanse(i.t.y.ch))
# species with 1 or 2 records
} else if (nrow(i.t.y) == 2 | nrow(i.t.y) == 1) {
spp_area[i,j] <- 1
# species without records
} else if (nrow(i.t.y) == 0) {
spp_area[i,j] <- 0
}
setTxtProgressBar(pb, i)
}
}
for(i in 1:length(sppq)) {
pb <- txtProgressBar(min = 0, max = 100, style = 3)
i.t <- mapp_qc_t[mapp_qc_t$species %in% sppq[i],]
for(j in 1:length(yr)) {
setTxtProgressBar(pb, i)
i.t.y <- i.t[i.t$year %in% yr[j],]
# species with more of 3 records
if (nrow(i.t.y) > 2) {
i.t.y.p <- vect(i.t.y, geom =c('x', 'y'))
i.t.y.ch<- convHull(i.t.y.p)
ç[i,j] <-m2_to_ha(expanse(i.t.y.ch))
# species with 1 or 2 records
} else if (nrow(i.t.y) == 2 | nrow(i.t.y) == 1) {
spp_area[i,j] <- nrow(i.t.y)
# species without records
} else if (nrow(i.t.y) == 0) {
spp_area[i,j] <- 0
}
setTxtProgressBar(pb, i)
}
}
m2_to_ha <- function(area_m2) {
area_ha <- area_m2 / 10000
return(area_ha)
}
for(i in 1:length(sppq)) {
pb <- txtProgressBar(min = 0, max = 100, style = 3)
i.t <- mapp_qc_t[mapp_qc_t$species %in% sppq[i],]
for(j in 1:length(yr)) {
setTxtProgressBar(pb, i)
i.t.y <- i.t[i.t$year %in% yr[j],]
# species with more of 3 records
if (nrow(i.t.y) > 2) {
i.t.y.p <- vect(i.t.y, geom =c('x', 'y'))
i.t.y.ch<- convHull(i.t.y.p)
ç[i,j] <-m2_to_ha(expanse(i.t.y.ch))
# species with 1 or 2 records
} else if (nrow(i.t.y) == 2 | nrow(i.t.y) == 1) {
spp_area[i,j] <- nrow(i.t.y)
# species without records
} else if (nrow(i.t.y) == 0) {
spp_area[i,j] <- 0
}
setTxtProgressBar(pb, i)
}
}
spp_area <- as.data.frame(matrix(nrow = length(sppq), ncol =  1+length(yr)))
names(spp_area) <- c( yr, 'species')
spp_area$species <- sppq
for(i in 1:length(sppq)) {
pb <- txtProgressBar(min = 0, max = 100, style = 3)
i.t <- mapp_qc_t[mapp_qc_t$species %in% sppq[i],]
for(j in 1:length(yr)) {
setTxtProgressBar(pb, i)
i.t.y <- i.t[i.t$year %in% yr[j],]
# species with more of 3 records
if (nrow(i.t.y) > 2) {
i.t.y.p <- vect(i.t.y, geom =c('x', 'y'))
i.t.y.ch<- convHull(i.t.y.p)
ç[i,j] <-m2_to_ha(expanse(i.t.y.ch))
# species with 1 or 2 records
} else if (nrow(i.t.y) == 2 | nrow(i.t.y) == 1) {
spp_area[i,j] <- nrow(i.t.y)
# species without records
} else if (nrow(i.t.y) == 0) {
spp_area[i,j] <- 0
}
setTxtProgressBar(pb, i)
}
}
library(rgbif)
library(scrubr)
#######################################
## DOWNLOAD AND CLEAN DATA FROM GBIF ##
#######################################
library(rgbif)
library(scrubr)
library(maps)
library(ggplot2)
library(terra)
library(geodata)
setwd('/Users/ccruzr/Library/Mobile Documents/com~apple~CloudDocs/Cristian/Documents/Estudios/Postgrado/PhD/Courses/Modeling and Indicators Bios2/Alien_Indicator')
getwd()
install.packages('scrubr')
library(scrubr)
spp_area
for(i in 1:length(sppq)) {
pb <- txtProgressBar(min = 0, max = 100, style = 3)
i.t <- mapp_qc_t[mapp_qc_t$species %in% sppq[i],]
for(j in 1:length(yr)) {
setTxtProgressBar(pb, i)
i.t.y <- i.t[i.t$year %in% yr[j],]
# species with more of 3 records
if (nrow(i.t.y) > 2) {
i.t.y.p <- vect(i.t.y, geom =c('x', 'y'))
i.t.y.ch<- convHull(i.t.y.p)
ç[i,j] <-m2_to_ha(expanse(i.t.y.ch))
# species with 1 or 2 records
} else if (nrow(i.t.y) == 2 | nrow(i.t.y) == 1) {
spp_area[i,j] <- nrow(i.t.y)
# species without records
} else if (nrow(i.t.y) == 0) {
spp_area[i,j] <- 0
}
setTxtProgressBar(pb, i)
}
}
spp_area <- read.csv('02ProcessedData/_invasive_spp.csv')
setwd('/Users/ccruzr/Library/Mobile Documents/com~apple~CloudDocs/Cristian/Documents/Estudios/Postgrado/PhD/Courses/Modeling and Indicators Bios2/Alien_Indicator')
getwd()
spp_area <- read.csv('/02ProcessedData/_invasive_spp.csv')
spp_area <- read.delim('/02ProcessedData/_invasive_spp.csv')
spp_area <- data.table::fread('/02ProcessedData/_invasive_spp.csv')
spp_area <- data.table::fread('02ProcessedData/_invasive_spp.csv')
spp_area <- data.table::fread('/Users/ccruzr/Library/Mobile Documents/com~apple~CloudDocs/Cristian/Documents/Estudios/Postgrado/PhD/Courses/Modeling and Indicators Bios2/Alien_Indicator/02ProcessedData/area_invasive_spp.csv')
spp_area
spp_area <- read.csv('/Users/ccruzr/Library/Mobile Documents/com~apple~CloudDocs/Cristian/Documents/Estudios/Postgrado/PhD/Courses/Modeling and Indicators Bios2/Alien_Indicator/02ProcessedData/area_invasive_spp.csv', header = T)
spp_area2 <-log1p(spp_area)
nanmes(spp_area)
names(spp_area)
spp_area2 <-log1p(spp_area((1:55))
spp_area2 <- log1p(spp_area(,c(1:55)))
spp_area(,c(1:55)
)
spp_area2 <- log1p(spp_area[c,(1:55)])
spp_area[c,(1:55)]
spp_area2 <- log1p(spp_area[,c(1:55)])
spp_area2$species <- spp_area$species
View(spp_area2)
spp_area2 <- round(log1p(spp_area[,c(1:55)])),2
spp_area2 <- round(log1p(spp_area[,c(1:55)]),2)
spp_area2$species <- spp_area$species
spp_area2 <- (log1p(spp_area[,c(1:55)]))
spp_area2$species <- spp_area$species
names(spp_area)<- gsub('x', '',names(spp_area))
names(spp_area2)<- gsub('x', '',names(spp_area2))
names(spp_area2)<- gsub('X', '',names(spp_area2))
spp_area2 <- (log1p(spp_area[,c(1:55)]))
names(spp_area2)<- gsub('X', '',names(spp_area2))
sorted_colnames <- names(spp_area2)[order(colMeans(spp_area2))]
sorted_colnames
yr
yr[!NA]
sppq
mapp_qc_t
m2_to_ha <- function(area_m2) {
area_ha <- area_m2 / 10000
return(area_ha)
}
for(i in 1:length(sppq)) {
pb <- txtProgressBar(min = 0, max = 100, style = 3)
i.t <- mapp_qc_t[mapp_qc_t$species %in% sppq[i],]
for(j in 1:length(yr)) {
setTxtProgressBar(pb, i)
i.t.y <- i.t[i.t$year %in% yr[j],]
# species with more of 3 records
if (nrow(i.t.y) > 2) {
i.t.y.p <- vect(i.t.y, geom =c('x', 'y'))
i.t.y.ch<- convHull(i.t.y.p)
ç[i,j] <-m2_to_ha(expanse(i.t.y.ch))
# species with 1 or 2 records
} else if (nrow(i.t.y) == 2 | nrow(i.t.y) == 1) {
spp_area[i,j] <- nrow(i.t.y)
# species without records
} else if (nrow(i.t.y) == 0) {
spp_area[i,j] <- 0
}
setTxtProgressBar(pb, i)
}
}
for(i in 1:length(sppq)) {
#pb <- txtProgressBar(min = 0, max = 100, style = 3)
i.t <- mapp_qc_t[mapp_qc_t$species %in% sppq[i],]
for(j in 1:length(yr)) {
setTxtProgressBar(pb, i)
i.t.y <- i.t[i.t$year %in% yr[j],]
# species with more of 3 records
if (nrow(i.t.y) > 2) {
i.t.y.p <- vect(i.t.y, geom =c('x', 'y'))
i.t.y.ch<- convHull(i.t.y.p)
ç[i,j] <-m2_to_ha(expanse(i.t.y.ch))
# species with 1 or 2 records
} else if (nrow(i.t.y) == 2 | nrow(i.t.y) == 1) {
spp_area[i,j] <- nrow(i.t.y)
# species without records
} else if (nrow(i.t.y) == 0) {
spp_area[i,j] <- 0
}
#setTxtProgressBar(pb, i)
}
}
i.t.y.ch<- convHull(i.t.y.p)
ç[i,j] <-m2_to_ha(expanse(i.t.y.ch))
for(i in 1:length(sppq)) {
pb <- txtProgressBar(min = 0, max = 100, style = 3)
i.t <- mapp_qc_t[mapp_qc_t$species %in% sppq[i],]
for(j in 1:length(yr)) {
setTxtProgressBar(pb, i)
i.t.y <- i.t[i.t$year %in% yr[j],]
# species with more of 3 records
if (nrow(i.t.y) > 2) {
i.t.y.p <- vect(i.t.y, geom =c('x', 'y'))
i.t.y.ch<- convHull(i.t.y.p)
spp_area[i,j] <-m2_to_ha(expanse(i.t.y.ch))
# species with 1 or 2 records
} else if (nrow(i.t.y) == 2 | nrow(i.t.y) == 1) {
spp_area[i,j] <- nrow(i.t.y)
# species without records
} else if (nrow(i.t.y) == 0) {
spp_area[i,j] <- 0
}
setTxtProgressBar(pb, i)
}
}
yr
yr[-46]
yr<- yr[-46]
sppq <- unique(mapp_qc_t_70$species)
## new dataframe
spp_area <- as.data.frame(matrix(nrow = length(sppq), ncol =  1+length(yr)))
names(spp_area) <- c( yr, 'species')
spp_area$species <- sppq
## count number of records per year, per species
for(i in 1:length(sppq)) {
i.t <- mapp_qc_t[mapp_qc_t$species %in% sppq[i],]
for(j in 1:length(yr)) {
i.t.y <- i.t[i.t$year %in% yr[j],]
if (nrow(i.t.y) > 2) {
spp_records[i,j] <- nrow(i.t.y)
} else if (nrow(i.t.y) == 2 | nrow(i.t.y) == 1) {
spp_records[i,j] <- nrow(i.t.y)
} else if (nrow(i.t.y) == 0) {
spp_records[i,j] <- 0
}
}
}
m2_to_ha <- function(area_m2) {
area_ha <- area_m2 / 10000
return(area_ha)
}
for(i in 1:length(sppq)) {
pb <- txtProgressBar(min = 0, max = 100, style = 3)
i.t <- mapp_qc_t[mapp_qc_t$species %in% sppq[i],]
for(j in 1:length(yr)) {
setTxtProgressBar(pb, i)
i.t.y <- i.t[i.t$year %in% yr[j],]
# species with more of 3 records
if (nrow(i.t.y) > 2) {
i.t.y.p <- vect(i.t.y, geom =c('x', 'y'))
i.t.y.ch<- convHull(i.t.y.p)
spp_area[i,j] <-m2_to_ha(expanse(i.t.y.ch))
# species with 1 or 2 records
} else if (nrow(i.t.y) == 2 | nrow(i.t.y) == 1) {
spp_area[i,j] <- nrow(i.t.y)
# species without records
} else if (nrow(i.t.y) == 0) {
spp_area[i,j] <- 0
}
setTxtProgressBar(pb, i)
}
}
spp_area2 <- (log1p(spp_area[,c(1:55)]))
names(spp_area)
spp_area2 <- (log1p(spp_area[,c(1:54)]))
names(spp_area2)
# Get column names sorted by the mean of their values
sorted_colnames <- names(spp_area2)[order(colMeans(spp_area2))]
sorted_colnames
yr
yr[order(yr)]
yr<- yr[order(yr)]
sppq <- unique(mapp_qc_t_70$species)
## new dataframe
spp_area <- as.data.frame(matrix(nrow = length(sppq), ncol =  1+length(yr)))
names(spp_area) <- c( yr, 'species')
spp_area$species <- sppq
spp_records <- spp_area
## count number of records per year, per species
for(i in 1:length(sppq)) {
i.t <- mapp_qc_t[mapp_qc_t$species %in% sppq[i],]
for(j in 1:length(yr)) {
i.t.y <- i.t[i.t$year %in% yr[j],]
if (nrow(i.t.y) > 2) {
spp_records[i,j] <- nrow(i.t.y)
} else if (nrow(i.t.y) == 2 | nrow(i.t.y) == 1) {
spp_records[i,j] <- nrow(i.t.y)
} else if (nrow(i.t.y) == 0) {
spp_records[i,j] <- 0
}
}
}
m2_to_ha <- function(area_m2) {
area_ha <- area_m2 / 10000
return(area_ha)
}
for(i in 1:length(sppq)) {
pb <- txtProgressBar(min = 0, max = 100, style = 3)
i.t <- mapp_qc_t[mapp_qc_t$species %in% sppq[i],]
for(j in 1:length(yr)) {
setTxtProgressBar(pb, i)
i.t.y <- i.t[i.t$year %in% yr[j],]
# species with more of 3 records
if (nrow(i.t.y) > 2) {
i.t.y.p <- vect(i.t.y, geom =c('x', 'y'))
i.t.y.ch<- convHull(i.t.y.p)
spp_area[i,j] <-m2_to_ha(expanse(i.t.y.ch))
# species with 1 or 2 records
} else if (nrow(i.t.y) == 2 | nrow(i.t.y) == 1) {
spp_area[i,j] <- nrow(i.t.y)
# species without records
} else if (nrow(i.t.y) == 0) {
spp_area[i,j] <- 0
}
setTxtProgressBar(pb, i)
}
}
write.csv(spp_area, '02ProcessedData/_invasive_spp.csv', row.names = F)
spp_area2 <- (log1p(spp_area[,c(1:54)]))
spp_area2 <- (log1p(spp_area[,c(1:54)]))
names(spp_area2) <- gsub('X', '',names(spp_area2))
spp_area2$species <- spp_area$species
names(spp_area)
for(i in 1:length(sppq)) {
pb <- txtProgressBar(min = 0, max = 100, style = 3)
i.t <- mapp_qc_t[mapp_qc_t$species %in% sppq[i],]
for(j in 1:length(yr)) {
setTxtProgressBar(pb, i)
i.t.y <- i.t[i.t$year %in% yr[j],]
# species with more of 3 records
if (nrow(i.t.y) > 2) {
i.t.y.p <- vect(i.t.y, geom =c('x', 'y'))
i.t.y.ch<- convHull(i.t.y.p)
spp_area[i,j] <-m2_to_ha(expanse(i.t.y.ch))
# species with 1 or 2 records
} else if (nrow(i.t.y) == 2 | nrow(i.t.y) == 1) {
spp_area[i,j] <- nrow(i.t.y)
# species without records
} else if (nrow(i.t.y) == 0) {
spp_area[i,j] <- NA
}
setTxtProgressBar(pb, i)
}
}
spp_area2 <- (log1p(spp_area[,c(1:54)]))
spp_area2$species <- spp_area$species
names(spp_area)
View(mapp_qc_t_70)
View(spp_area2)
View(spp_records)
class(results)
write.csv(results, '00RawData/RawData.csv')
write.csv(results, '/00RawData/RawData.csv')
setwd('/Users/ccruzr/Library/Mobile Documents/com~apple~CloudDocs/Cristian/Documents/Estudios/Postgrado/PhD/Courses/Modeling and Indicators Bios2/alien_index_course')
getwd()
write.csv(results, '/00RawData/RawData.csv')
write.csv(results, '00RawData/RawData.csv')
results2 <- read.csv('00RawData/RawData.csv', header = T)
results <- read.csv('00RawData/RawData.csv', header = T)
